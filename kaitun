-- Kaitun Blox Fruits (Farm real + Marines + FastMode)
-- Solo educativo. Puede ser baneable. Usa bajo tu propio riesgo.

if setfpscap then setfpscap(20) end
for _,v in pairs(game:GetDescendants()) do
    if v:IsA("ParticleEmitter") or v:IsA("Trail") then v.Enabled = false end
    if v:IsA("Explosion") then v.Visible = false end
    if v:IsA("Decal") or v:IsA("Texture") then v.Transparency = 1 end
    if v:IsA("Sound") then v.Volume = 0 end
end
if game.Lighting then
    game.Lighting.FogEnd = 1e6
    game.Lighting.GlobalShadows = false
    game.Lighting.Brightness = 1
end

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

-- Selección de Marines
local function SelectMarines()
    local Remote = ReplicatedStorage:FindFirstChild("Remotes")
    if Remote and Remote:FindFirstChild("CommF_") then
        Remote.CommF_:InvokeServer("SetTeam", "Marines")
    end
    player.Neutral = false
end

if player.Team == nil or player.Team.Name ~= "Marines" then
    SelectMarines()
    repeat wait() until player.Team and player.Team.Name == "Marines"
end

-- Tabla de quests y mobs (expándela para otros mares/quests)
local QuestTable = {
    {lvl=1, max=15, quest="BanditQuest1", part=1, mob="Bandit", npcPos=Vector3.new(1060,16,1547)},
    {lvl=15, max=30, quest="MonkeyQuest", part=1, mob="Monkey", npcPos=Vector3.new(-1602,38,153)},
    {lvl=30, max=55, quest="GorillaQuest", part=1, mob="Gorilla", npcPos=Vector3.new(-1322,39,-524)},
    -- Agrega más quests aquí para los siguientes niveles...
}

local function GetQuest()
    local plvl = player.Data.Level.Value
    for i=#QuestTable,1,-1 do
        if plvl >= QuestTable[i].lvl then
            return QuestTable[i]
        end
    end
    return QuestTable[1]
end

local function TakeQuest(quest, part)
    local Remote = ReplicatedStorage:FindFirstChild("Remotes")
    if Remote and Remote:FindFirstChild("CommF_") then
        Remote.CommF_:InvokeServer("StartQuest", quest, part)
    end
end

local function TeleportTo(pos)
    local char = player.Character or player.CharacterAdded:Wait()
    local root = char:FindFirstChild("HumanoidRootPart")
    if root then
        root.CFrame = CFrame.new(pos + Vector3.new(0,3,0))
    end
end

local function FindMob(mobName)
    for _,mob in pairs(Workspace.Enemies:GetChildren()) do
        if mob.Name == mobName and mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
            return mob
        end
    end
    return nil
end

local function AttackMob(mob)
    local char = player.Character
    local tool = char and char:FindFirstChildOfClass("Tool")
    if mob and mob:FindFirstChild("HumanoidRootPart") then
        TeleportTo(mob.HumanoidRootPart.Position)
        if tool then
            tool:Activate()
        end
    end
end

-- Loop principal de farm
task.spawn(function()
    while true do
        local q = GetQuest()
        TakeQuest(q.quest, q.part)
        wait(0.5)
        TeleportTo(q.npcPos)
        wait(0.5)
        local mob = FindMob(q.mob)
        if mob then
            while mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 do
                AttackMob(mob)
                wait(0.1)
            end
        else
            -- Si no hay mobs vivos, espera respawn
            wait(1)
        end
        wait(0.5)
    end
end)

print("Kaitun autofarm: Marines seleccionado, farm automático, fast mode ON.")
